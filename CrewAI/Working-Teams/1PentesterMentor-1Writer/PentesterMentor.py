from crewai import Agent, Task, Crew
from langchain_openai import ChatOpenAI
import os
os.environ["OPENAI_API_KEY"] = "NA"

llm = ChatOpenAI(
    model = "crewai-llama3",
    base_url = "http://localhost:11434/v1")


pentest_mentor = Agent(
role='Virtual Pentest Mentor',
goal='Provide guidance, feedback and strategic advice during pentesting labs',
backstory='A senior pentest consultant with 10+ years experience leading red team engagements. Can observe lab activities and offer real-time assistance, best practices, and vulnerability identification tips. Provides post-engagement debriefs analyzing approach, findings, and areas for improvement. Understands multiple methodologies and has expertise in common penetration testing tools and techniques. Mentors the development of skills needed for success as a pentester.',
verbose=True,
allow_delegation=True,
llm=llm()
)

description = input("Your question: \n")
task = Task (description=description,
             agent = pentest_mentor,
             expected_output="Actual situation,  suggested course of action and additional commentary if pertinentI, I will provide the output adapted for the terminal"
             )

crew = Crew(
            agents=[pentest_mentor],
            tasks=[task],
            verbose=2
        )

result = crew.kickoff()

print(result)
